{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word */\n\nconst CIMA_BASE = \"https://cima.aemps.es\";\n\n// Arranque y enganche del único botón\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Word) {\n    const sideload = document.getElementById(\"sideload-msg\");\n    const body = document.getElementById(\"app-body\");\n    if (sideload) sideload.style.display = \"none\";\n    if (body) body.style.display = \"block\";\n\n    const attach = () => {\n      const buscar = document.getElementById(\"btnBuscar\");\n      if (buscar && !buscar._h) {\n        buscar.addEventListener(\"click\", onBuscarPrincipioActivo);\n        buscar._h = true;\n      }\n    };\n    attach();\n    document.addEventListener(\"DOMContentLoaded\", attach);\n  }\n});\n\n/* ========= UI ========= */\nfunction setStatus(msg) {\n  const el = document.getElementById(\"status\");\n  if (el) el.textContent = msg || \"\";\n}\nfunction setIndicaciones(text) {\n  const el = document.getElementById(\"indicaciones\");\n  if (el) el.textContent = text && text.trim() ? text.trim() : \"—\";\n}\n\n/* ======== Word ======== */\nasync function getSelectedTextTrimmed() {\n  let text = \"\";\n  await Word.run(async (context) => {\n    const sel = context.document.getSelection();\n    sel.load(\"text\");\n    await context.sync();\n    text = (sel.text || \"\").replace(/[\\s\\u00A0]+$/g, \"\").trim();\n  });\n  return text;\n}\nasync function replaceSelection(text) {\n  await Word.run(async (context) => {\n    const sel = context.document.getSelection();\n    sel.insertText(text, Word.InsertLocation.replace);\n    await context.sync();\n  });\n}\n\n/* ======== Red/CIMA ======== */\n// fetch JSON con fallback CORS (solo dev)\nasync function fetchJSON(url, timeoutMs = 12000) {\n  const ctrl = new AbortController();\n  const to = setTimeout(() => ctrl.abort(), timeoutMs);\n  try {\n    const r = await fetch(url, { signal: ctrl.signal, headers: { Accept: \"application/json\" } });\n    if (!r.ok) throw new Error(`HTTP ${r.status}`);\n    return await r.json();\n  } catch (err) {\n    const proxied = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;\n    const r2 = await fetch(proxied, { headers: { Accept: \"application/json\" } });\n    if (!r2.ok) throw err;\n    return await r2.json();\n  } finally { clearTimeout(to); }\n}\n// fetch TEXT (HTML) con fallback CORS (solo dev)\nasync function fetchText(url, timeoutMs = 15000) {\n  const ctrl = new AbortController();\n  const to = setTimeout(() => ctrl.abort(), timeoutMs);\n  try {\n    const r = await fetch(url, { signal: ctrl.signal, headers: { Accept: \"text/html, text/plain\" } });\n    if (!r.ok) throw new Error(`HTTP ${r.status}`);\n    return await r.text();\n  } catch (err) {\n    const proxied = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;\n    const r2 = await fetch(proxied, { headers: { Accept: \"text/html, text/plain\" } });\n    if (!r2.ok) throw err;\n    return await r2.text();\n  } finally { clearTimeout(to); }\n}\n\n// Normaliza diferentes formatos de respuesta a lista\nfunction toList(resp) {\n  if (Array.isArray(resp)) return resp;\n  if (resp && Array.isArray(resp.resultados)) return resp.resultados; // paginado\n  if (resp && Array.isArray(resp.lista)) return resp.lista;\n  if (resp && Array.isArray(resp.datos)) return resp.datos;\n  if (resp && resp.nombre) return [resp];\n  return [];\n}\n\n// Búsqueda por nombre\nasync function searchMedsByName(name) {\n  const url = `${CIMA_BASE}/cima/rest/medicamentos?nombre=${encodeURIComponent(name)}`;\n  const resp = await fetchJSON(url);\n  return toList(resp);\n}\n\n// Detalle por nregistro (trae pactivos/principiosActivos + docs)\nasync function getMedByNregistro(nreg) {\n  const url = `${CIMA_BASE}/cima/rest/medicamento?nregistro=${encodeURIComponent(nreg)}`;\n  const resp = await fetchJSON(url);\n  const list = toList(resp);\n  return list.length ? list[0] : null;\n}\n\n/* ======== Formato de salida ======== */\nfunction toTitleCaseWord(w) { return w ? w[0].toUpperCase() + w.slice(1).toLowerCase() : w; }\nfunction formatBrandFromSelection(sel) {\n  const trimmed = (sel || \"\").trim();\n  if (!trimmed) return \"\";\n  return trimmed.split(/\\s+/).map((t) => toTitleCaseWord(t)).join(\" \");\n}\nfunction normalizeActiveName(s) {\n  if (!s) return s;\n  let out = s.toLowerCase().trim().replace(/\\s+/g, \" \");\n  out = out.replace(/^(.+)\\s+acido$/i, \"ácido $1\");\n  out = out.replace(/\\bacido\\b/g, \"ácido\");\n  out = out.replace(/\\bsodico\\b/g, \"sódico\").replace(/\\bpotasico\\b/g, \"potásico\");\n  out = out.replace(/\\bclorhidrico\\b/g, \"clorhídrico\").replace(/\\bhidroxido\\b/g, \"hidróxido\");\n  out = out.replace(/\\bacetilsalicilico\\b/g, \"acetilsalicílico\");\n  return out;\n}\nfunction formatActives(actives) { return (actives || []).map(normalizeActiveName).join(\", \"); }\n// Extrae principios activos\nfunction getActivesFromMed(med) {\n  if (Array.isArray(med?.principiosActivos) && med.principiosActivos.length) {\n    const xs = med.principiosActivos.map((p) => p?.nombre || p?.principioActivo || p?.principio || \"\").filter(Boolean);\n    if (xs.length) return xs;\n  }\n  if (typeof med?.pactivos === \"string\" && med.pactivos.trim()) return [med.pactivos.trim()];\n  if (med?.pactivos && typeof med.pactivos === \"object\" && med.pactivos.nombre) return [String(med.pactivos.nombre).trim()];\n  return [];\n}\n\n// Corrige la marca desde el nombre oficial (quita dosis/forma/EFG)\nfunction deriveBrandFromMedName(med) {\n  const raw = (med?.nombre || \"\").trim();\n  if (!raw) return \"\";\n  const tokens = raw.split(/\\s+/);\n  const chosen = [];\n  const STOP = new Set([\n    \"COMPRIMIDOS\",\"COMPRIMIDO\",\"CAPSULAS\",\"CÁPSULAS\",\"CAPSULA\",\"CÁPSULA\",\"EFG\",\"TURBUHALER\",\n    \"AEROSOL\",\"INHALADOR\",\"INHALACIÓN\",\"INHALACION\",\"SOLUCIÓN\",\"SOLUCION\",\"SUSPENSIÓN\",\"SUSPENSION\",\n    \"JARABE\",\"TABLETAS\",\"TABLETA\",\"TAB\",\"VIAL\",\"VIALES\",\"RETARD\",\"SR\",\"ER\",\"XR\",\"MR\",\"LIBERACIÓN\",\"LIBERACION\",\n    \"RECUBIERTOS\",\"RECUBIERTO\",\"GASTRORRESISTENTES\",\"DISPERSABLE\",\"DISPERSABLES\",\"COLIRIO\",\"PARCHES\",\"PARCHE\",\n    \"SPRAY\",\"CREMA\",\"GOTAS\",\"POLVO\",\"SOBRES\",\"UNIDOSIS\",\"SOLUBLE\",\"ORAL\",\"NASAL\",\"OFTÁLMICA\",\"OFTALMICA\",\n  ]);\n  for (const t of tokens) {\n    const T = t.toUpperCase();\n    if (/^\\d/.test(T)) break;\n    if (/^\\d+([.,]\\d+)?(\\/\\d+([.,]\\d+)?)?$/.test(T)) break;\n    if (/^(MG|MCG|ΜG|UG|µG|G|ML|%|IU|UI)$/.test(T)) break;\n    if (STOP.has(T)) break;\n    chosen.push(t);\n  }\n  const base = chosen.length ? chosen : tokens.slice(0, 1);\n  return base.map(toTitleCaseWord).join(\" \");\n}\n\n/* ======== Erratas: variantes de búsqueda ======== */\nasync function trySearchVariants(query) {\n  const tried = new Set();\n  const tryVariant = async (v) => {\n    const key = v.toLowerCase();\n    if (tried.has(key)) return null;\n    tried.add(key);\n    const list = await searchMedsByName(v);\n    if (list.length) return { list, usedVariant: v };\n    return null;\n  };\n  const rules = [\n    (s) => s.replace(/y/gi, \"i\"),\n    (s) => s.replace(/i/gi, \"y\"),\n    (s) => s.replace(/z/gi, \"s\"),\n    (s) => s.replace(/s/gi, \"z\"),\n    (s) => s.replace(/v/gi, \"b\"),\n    (s) => s.replace(/b/gi, \"v\"),\n    (s) => s.replace(/h/gi, \"\"),\n  ];\n  for (const fn of rules) {\n    const v = fn(query);\n    if (v !== query) {\n      const res = await tryVariant(v);\n      if (res) return res;\n    }\n  }\n  for (let i = 0; i < query.length; i++) {\n    const v = query.slice(0, i) + query.slice(i + 1);\n    const res = await tryVariant(v);\n    if (res) return res;\n  }\n  return null;\n}\n\n/* ======== Indicaciones (FT/Prospecto) ======== */\nfunction stripSpaces(s) { return s.replace(/[ \\t]+\\n/g, \"\\n\").replace(/\\n{3,}/g, \"\\n\\n\").trim(); }\nfunction normalizeNoAccents(s) { return s.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"); }\n\nfunction extractIndicationsFromHTML(html) {\n  const doc = new DOMParser().parseFromString(html, \"text/html\");\n  const text = doc.body ? doc.body.innerText : html;\n  const plain = stripSpaces(text);\n\n  // 1) Ficha Técnica: sección 4.1 hasta 4.2/4.3/5.\n  let reFT = /4\\.\\s*1[\\s\\S]*?(?=4\\.\\s*2|4\\.\\s*3|5\\.)/i;\n  let m = plain.match(reFT);\n  if (m) {\n    let out = m[0];\n    const idx = out.toLowerCase().indexOf(\"indicaciones\");\n    if (idx > -1) out = out.slice(idx);\n    return stripSpaces(out);\n  }\n\n  // 2) Prospecto: \"para qué se utiliza\"\n  const noAcc = normalizeNoAccents(plain.toLowerCase());\n  const idxPQ = noAcc.indexOf(\"para que se utiliza\");\n  if (idxPQ > -1) {\n    const rest = plain.slice(idxPQ);\n    const m2 = rest.match(/^[\\s\\S]*?(?=\\n\\s*\\d+\\s*\\.)/m);\n    return stripSpaces(m2 ? m2[0] : rest);\n  }\n\n  // 3) Fallback: buscar \"indicaciones\"\n  const idxInd = noAcc.indexOf(\"indicaciones\");\n  if (idxInd > -1) {\n    const rest = plain.slice(idxInd);\n    const m3 = rest.match(/^[\\s\\S]*?(?=\\n\\s*\\d+\\s*\\.)/m);\n    return stripSpaces(m3 ? m3[0] : rest);\n  }\n\n  return null;\n}\n\nfunction pickDocHtml(med, tipoPreferido = 1) {\n  if (!Array.isArray(med?.docs)) return null;\n  const preferred = med.docs.filter(d => d.tipo === tipoPreferido && d.urlHtml);\n  if (preferred.length) return preferred[0];\n  const anyHtml = med.docs.find(d => d.urlHtml);\n  return anyHtml || null;\n}\n\nasync function getIndicaciones(med) {\n  try {\n    const docFT = pickDocHtml(med, 1); // Ficha Técnica\n    const docP = pickDocHtml(med, 2);  // Prospecto\n    const chosen = docFT || docP;\n    if (!chosen || !chosen.urlHtml) return null;\n\n    const html = await fetchText(chosen.urlHtml);\n    const ind = extractIndicationsFromHTML(html);\n    if (!ind) return null;\n\n    // Limita a 1200 caracteres sin cortar palabra\n    const max = 1200;\n    if (ind.length <= max) return ind;\n    const cut = ind.lastIndexOf(\" \", max - 10);\n    return ind.slice(0, cut > 0 ? cut : max).trim() + \"…\";\n  } catch {\n    return null;\n  }\n}\n\n/* ======== Acción principal ======== */\nasync function onBuscarPrincipioActivo() {\n  try {\n    setStatus(\"Buscando...\");\n    setIndicaciones(\"—\");\n\n    const selected = await getSelectedTextTrimmed();\n    if (!selected) {\n      setStatus(\"Selecciona un nombre comercial.\");\n      return;\n    }\n\n    // Paso A: buscar candidatos\n    let list = await searchMedsByName(selected);\n\n    // Paso B: si no hay resultados, probar variantes por erratas\n    if (!list.length) {\n      const alt = await trySearchVariants(selected);\n      if (alt && alt.list && alt.list.length) {\n        list = alt.list;\n      }\n    }\n    if (!list.length) {\n      setStatus(\"No encontrado en CIMA.\");\n      return;\n    }\n\n    const candidato = list[0];\n\n    // Paso C: detalle por nregistro\n    const nreg = candidato.nregistro || candidato.nregistroId || candidato.id;\n    const medDetalle = nreg ? await getMedByNregistro(nreg) : null;\n    const med = medDetalle || candidato;\n\n    // Paso D: activos y reemplazo en el documento\n    const actives = getActivesFromMed(med);\n    if (!actives.length) {\n      setStatus(\"Sin principios activos en la respuesta.\");\n      return;\n    }\n    const brandCorrected = deriveBrandFromMedName(med);\n    const brandFallback = formatBrandFromSelection(selected);\n    const brandDisplay = brandCorrected || brandFallback;\n\n    await replaceSelection(`${brandDisplay} (${formatActives(actives)})`);\n    setStatus(\"Listo.\");\n\n    // Paso E: Indicaciones (solo panel)\n    setStatus(\"Buscando indicaciones…\");\n    const indic = await getIndicaciones(med);\n    if (indic) {\n      setIndicaciones(indic);\n      setStatus(\"Listo.\");\n    } else {\n      setIndicaciones(\"No se pudieron extraer las indicaciones de la Ficha Técnica/Prospecto.\");\n      setStatus(\"Listo.\");\n    }\n  } catch (e) {\n    console.error(e);\n    setStatus(\"Error consultando CIMA. Revisa tu conexión.\");\n  }\n}\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"utf-8\\\"/> <title>Farmacopedia</title> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <style>:root{--bg:#fff;--fg:#111827;--muted:#6b7280;--chip:#f3f4f6;--ring:#e5e7eb}*{box-sizing:border-box}body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--fg)}header{display:flex;align-items:center;gap:.5rem;padding:14px 16px;border-bottom:1px solid var(--ring)}.logo{width:32px;height:32px;border-radius:9999px;background:#111827;color:#fff;display:grid;place-items:center;font-weight:700}main{display:none;padding:16px}.btn{padding:10px 14px;border:0;border-radius:8px;background:#111827;color:#fff;cursor:pointer;font-weight:600}.btn:disabled{opacity:.6;cursor:not-allowed}#status{display:block;margin-top:10px;padding:8px 10px;border-radius:8px;background:var(--chip);color:var(--fg);min-height:1.5em}.section{margin-top:14px}.section h3{margin:0 0 6px 0;font-size:14px;color:var(--muted);font-weight:700;letter-spacing:.2px}.box{border:1px solid var(--ring);border-radius:8px;padding:10px;font-size:13px;line-height:1.35;max-height:220px;overflow:auto;white-space:pre-wrap}#sideload-msg{padding:16px}</style> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body> <header> <div class=\\\"logo\\\">F</div> <div> <div style=\\\"font-weight:700\\\">Farmacopedia</div> <div style=\\\"font-size:12px;color:#6b7280\\\">Selecciona el fármaco y pulsa el botón</div> </div> </header> <section id=\\\"sideload-msg\\\">Carga el complemento para continuar.</section> <main id=\\\"app-body\\\"> <button id=\\\"btnBuscar\\\" class=\\\"btn\\\">Buscar principio activo</button> <small id=\\\"status\\\"></small> <div class=\\\"section\\\"> <h3>Indicaciones</h3> <div id=\\\"indicaciones\\\" class=\\\"box\\\">—</div> </div> </main> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","_arrayLikeToArray","Array","_typeof","constructor","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CIMA_BASE","setStatus","msg","el","getElementById","textContent","setIndicaciones","text","trim","getSelectedTextTrimmed","_getSelectedTextTrimmed","_callee2","_context2","Word","run","_ref","_callee","context","sel","_context","getSelection","load","sync","_x8","replaceSelection","_x","_replaceSelection","_callee4","_context4","_ref2","_callee3","_context3","insertText","InsertLocation","_x9","fetchJSON","_x2","_fetchJSON","_callee5","url","timeoutMs","ctrl","to","proxied","r2","_t","_args5","_context5","AbortController","setTimeout","abort","fetch","signal","headers","Accept","ok","concat","status","json","encodeURIComponent","clearTimeout","fetchText","_x3","_fetchText","_callee6","_t2","_args6","_context6","toList","resp","isArray","resultados","lista","datos","nombre","searchMedsByName","_x4","_searchMedsByName","_callee7","name","_context7","getMedByNregistro","_x5","_getMedByNregistro","_callee8","nreg","list","_context8","toTitleCaseWord","slice","toLowerCase","formatBrandFromSelection","trimmed","split","map","join","normalizeActiveName","s","out","formatActives","actives","getActivesFromMed","med","principiosActivos","xs","principioActivo","principio","filter","Boolean","pactivos","String","deriveBrandFromMedName","raw","_step","tokens","chosen","STOP","Set","_iterator","toString","from","_unsupportedIterableToArray","_n","F","next","_createForOfIteratorHelper","T","has","push","err","trySearchVariants","_x6","_trySearchVariants","_callee0","query","tried","tryVariant","_i","_rules","fn","res","_v","_res","_context0","_ref3","_callee9","key","_context9","add","usedVariant","_x0","stripSpaces","extractIndicationsFromHTML","html","doc","DOMParser","parseFromString","plain","body","innerText","match","idx","indexOf","noAcc","normalize","idxPQ","rest","m2","idxInd","m3","pickDocHtml","tipoPreferido","docs","preferred","tipo","urlHtml","find","getIndicaciones","_x7","_getIndicaciones","_callee1","docFT","docP","ind","max","cut","_context1","lastIndexOf","onBuscarPrincipioActivo","_onBuscarPrincipioActivo","_callee10","selected","alt","candidato","brandCorrected","brandFallback","brandDisplay","indic","_t4","_t5","_context10","nregistro","nregistroId","id","console","error","Office","onReady","info","host","HostType","sideload","style","display","attach","buscar","_h","addEventListener","URL"],"sourceRoot":""}