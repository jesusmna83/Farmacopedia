/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var n={58394:function(n,t,r){"use strict";n.exports=r.p+"1fda685b81e1123773f6.css"}},t={};function r(e){var o=t[e];if(void 0!==o)return o.exports;var i=t[e]={exports:{}};return n[e](i,i.exports,r),i.exports}r.m=n,r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),r.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},function(){var n;r.g.importScripts&&(n=r.g.location+"");var t=r.g.document;if(!n&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(n=t.currentScript.src),!n)){var e=t.getElementsByTagName("script");if(e.length)for(var o=e.length-1;o>-1&&(!n||!/^http(s?):/.test(n));)n=e[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=n}(),r.b=document.baseURI||self.location.href,function(){function n(){var r,e,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(n,o,i,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return t(l,"_invoke",function(n,t,o){var i,a,c,s=0,l=o||[],f=!1,p={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function(n,t){return i=n,a=0,c=r,p.n=t,u}};function d(n,t){for(a=n,c=t,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,v=i[2];n>3?(o=v===t)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=r):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=t,p.n=i[1]):d<v&&(o=n<3||i[0]>t||t>v)&&(i[4]=n,i[5]=t,p.n=v,a=0))}if(o||n>1)return u;throw f=!0,t}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),a=l,c=v;(e=a<2?r:c)||!f;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=r}else if((e=(f=p.n<0)?c:n.call(t,p))!==u)break}catch(n){i=r,a=1,c=n}finally{s=1}}return{value:e,done:f}}}(n,i,a),!0),l}var u={};function s(){}function l(){}function f(){}e=Object.getPrototypeOf;var p=[][i]?e(e([][i]())):(t(e={},i,function(){return this}),e),d=f.prototype=s.prototype=Object.create(p);function v(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,t(n,a,"GeneratorFunction")),n.prototype=Object.create(d),n}return l.prototype=f,t(d,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,a,"GeneratorFunction"),t(d),t(d,a,"Generator"),t(d,i,function(){return this}),t(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:c,m:v}})()}function t(n,r,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}t=function(n,r,e,o){function a(r,e){t(n,r,function(n){return this._invoke(r,e,n)})}r?i?i(n,r,{value:e,enumerable:!o,configurable:!o,writable:!o}):n[r]=e:(a("next",0),a("throw",1),a("return",2))},t(n,r,e,o)}function r(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=Array(t);r<t;r++)e[r]=n[r];return e}function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e(n)}function o(n,t,r,e,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void r(n)}c.done?t(u):Promise.resolve(u).then(e,o)}function i(n){return function(){var t=this,r=arguments;return new Promise(function(e,i){var a=n.apply(t,r);function c(n){o(a,e,i,c,u,"next",n)}function u(n){o(a,e,i,c,u,"throw",n)}c(void 0)})}}var a="https://cima.aemps.es";function c(n){var t=document.getElementById("status");t&&(t.textContent=n||"")}function u(n){var t=document.getElementById("indicaciones");t&&(t.textContent=n&&n.trim()?n.trim():"—")}function s(){return l.apply(this,arguments)}function l(){return l=i(n().m(function t(){var r;return n().w(function(t){for(;;)switch(t.n){case 0:return r="",t.n=1,Word.run(function(){var t=i(n().m(function t(e){var o;return n().w(function(n){for(;;)switch(n.n){case 0:return(o=e.document.getSelection()).load("text"),n.n=1,e.sync();case 1:r=(o.text||"").replace(/[\s\u00A0]+$/g,"").trim();case 2:return n.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2,r)}},t)})),l.apply(this,arguments)}function f(n){return p.apply(this,arguments)}function p(){return p=i(n().m(function t(r){return n().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Word.run(function(){var t=i(n().m(function t(e){return n().w(function(n){for(;;)switch(n.n){case 0:return e.document.getSelection().insertText(r,Word.InsertLocation.replace),n.n=1,e.sync();case 1:return n.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),p.apply(this,arguments)}function d(n){return v.apply(this,arguments)}function v(){return v=i(n().m(function t(r){var e,o,i,a,c,u,s,l=arguments;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return e=l.length>1&&void 0!==l[1]?l[1]:12e3,o=new AbortController,i=setTimeout(function(){return o.abort()},e),n.p=1,n.n=2,fetch(r,{signal:o.signal,headers:{Accept:"application/json"}});case 2:if((a=n.v).ok){n.n=3;break}throw new Error("HTTP ".concat(a.status));case 3:return n.n=4,a.json();case 4:case 8:return n.a(2,n.v);case 5:return n.p=5,s=n.v,c="https://api.allorigins.win/raw?url=".concat(encodeURIComponent(r)),n.n=6,fetch(c,{headers:{Accept:"application/json"}});case 6:if((u=n.v).ok){n.n=7;break}throw s;case 7:return n.n=8,u.json();case 9:return n.p=9,clearTimeout(i),n.f(9);case 10:return n.a(2)}},t,null,[[1,5,9,10]])})),v.apply(this,arguments)}function h(n){return m.apply(this,arguments)}function m(){return m=i(n().m(function t(r){var e,o,i,a,c,u,s,l=arguments;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return e=l.length>1&&void 0!==l[1]?l[1]:15e3,o=new AbortController,i=setTimeout(function(){return o.abort()},e),n.p=1,n.n=2,fetch(r,{signal:o.signal,headers:{Accept:"text/html, text/plain"}});case 2:if((a=n.v).ok){n.n=3;break}throw new Error("HTTP ".concat(a.status));case 3:return n.n=4,a.text();case 4:case 8:return n.a(2,n.v);case 5:return n.p=5,s=n.v,c="https://api.allorigins.win/raw?url=".concat(encodeURIComponent(r)),n.n=6,fetch(c,{headers:{Accept:"text/html, text/plain"}});case 6:if((u=n.v).ok){n.n=7;break}throw s;case 7:return n.n=8,u.text();case 9:return n.p=9,clearTimeout(i),n.f(9);case 10:return n.a(2)}},t,null,[[1,5,9,10]])})),m.apply(this,arguments)}function y(n){return Array.isArray(n)?n:n&&Array.isArray(n.resultados)?n.resultados:n&&Array.isArray(n.lista)?n.lista:n&&Array.isArray(n.datos)?n.datos:n&&n.nombre?[n]:[]}function b(n){return g.apply(this,arguments)}function g(){return(g=i(n().m(function t(r){var e,o;return n().w(function(n){for(;;)switch(n.n){case 0:return e="".concat(a,"/cima/rest/medicamentos?nombre=").concat(encodeURIComponent(r)),n.n=1,d(e);case 1:return o=n.v,n.a(2,y(o))}},t)}))).apply(this,arguments)}function A(n){return S.apply(this,arguments)}function S(){return(S=i(n().m(function t(r){var e,o,i;return n().w(function(n){for(;;)switch(n.n){case 0:return e="".concat(a,"/cima/rest/medicamento?nregistro=").concat(encodeURIComponent(r)),n.n=1,d(e);case 1:return o=n.v,i=y(o),n.a(2,i.length?i[0]:null)}},t)}))).apply(this,arguments)}function w(n){return n?n[0].toUpperCase()+n.slice(1).toLowerCase():n}function I(n){var t=(n||"").trim();return t?t.split(/\s+/).map(function(n){return w(n)}).join(" "):""}function O(n){if(!n)return n;var t=n.toLowerCase().trim().replace(/\s+/g," ");return(t=(t=(t=(t=t.replace(/^(.+)\s+acido$/i,"ácido $1")).replace(/\bacido\b/g,"ácido")).replace(/\bsodico\b/g,"sódico").replace(/\bpotasico\b/g,"potásico")).replace(/\bclorhidrico\b/g,"clorhídrico").replace(/\bhidroxido\b/g,"hidróxido")).replace(/\bacetilsalicilico\b/g,"acetilsalicílico")}function E(n){return(n||[]).map(O).join(", ")}function C(n){if(Array.isArray(null==n?void 0:n.principiosActivos)&&n.principiosActivos.length){var t=n.principiosActivos.map(function(n){return(null==n?void 0:n.nombre)||(null==n?void 0:n.principioActivo)||(null==n?void 0:n.principio)||""}).filter(Boolean);if(t.length)return t}return"string"==typeof(null==n?void 0:n.pactivos)&&n.pactivos.trim()?[n.pactivos.trim()]:null!=n&&n.pactivos&&"object"===e(n.pactivos)&&n.pactivos.nombre?[String(n.pactivos.nombre).trim()]:[]}function L(n){var t=((null==n?void 0:n.nombre)||"").trim();if(!t)return"";var e,o=t.split(/\s+/),i=[],a=new Set(["COMPRIMIDOS","COMPRIMIDO","CAPSULAS","CÁPSULAS","CAPSULA","CÁPSULA","EFG","TURBUHALER","AEROSOL","INHALADOR","INHALACIÓN","INHALACION","SOLUCIÓN","SOLUCION","SUSPENSIÓN","SUSPENSION","JARABE","TABLETAS","TABLETA","TAB","VIAL","VIALES","RETARD","SR","ER","XR","MR","LIBERACIÓN","LIBERACION","RECUBIERTOS","RECUBIERTO","GASTRORRESISTENTES","DISPERSABLE","DISPERSABLES","COLIRIO","PARCHES","PARCHE","SPRAY","CREMA","GOTAS","POLVO","SOBRES","UNIDOSIS","SOLUBLE","ORAL","NASAL","OFTÁLMICA","OFTALMICA"]),c=function(n,t){var e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=function(n,t){if(n){if("string"==typeof n)return r(n,t);var e={}.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(n,t):void 0}}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var o=0,i=function(){};return{s:i,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return c=n.done,n},e:function(n){u=!0,a=n},f:function(){try{c||null==e.return||e.return()}finally{if(u)throw a}}}}(o);try{for(c.s();!(e=c.n()).done;){var u=e.value,s=u.toUpperCase();if(/^\d/.test(s))break;if(/^\d+([.,]\d+)?(\/\d+([.,]\d+)?)?$/.test(s))break;if(/^(MG|MCG|ΜG|UG|µG|G|ML|%|IU|UI)$/.test(s))break;if(a.has(s))break;i.push(u)}}catch(n){c.e(n)}finally{c.f()}return(i.length?i:o.slice(0,1)).map(w).join(" ")}function R(n){return T.apply(this,arguments)}function T(){return T=i(n().m(function t(r){var e,o,a,c,u,s,l,f,p,d;return n().w(function(t){for(;;)switch(t.n){case 0:e=new Set,o=function(){var t=i(n().m(function t(r){var o,i;return n().w(function(n){for(;;)switch(n.n){case 0:if(o=r.toLowerCase(),!e.has(o)){n.n=1;break}return n.a(2,null);case 1:return e.add(o),n.n=2,b(r);case 2:if(!(i=n.v).length){n.n=3;break}return n.a(2,{list:i,usedVariant:r});case 3:return n.a(2,null)}},t)}));return function(n){return t.apply(this,arguments)}}(),a=0,c=[function(n){return n.replace(/y/gi,"i")},function(n){return n.replace(/i/gi,"y")},function(n){return n.replace(/z/gi,"s")},function(n){return n.replace(/s/gi,"z")},function(n){return n.replace(/v/gi,"b")},function(n){return n.replace(/b/gi,"v")},function(n){return n.replace(/h/gi,"")}];case 1:if(!(a<c.length)){t.n=4;break}if(u=c[a],(s=u(r))===r){t.n=3;break}return t.n=2,o(s);case 2:if(!(l=t.v)){t.n=3;break}return t.a(2,l);case 3:a++,t.n=1;break;case 4:f=0;case 5:if(!(f<r.length)){t.n=8;break}return p=r.slice(0,f)+r.slice(f+1),t.n=6,o(p);case 6:if(!(d=t.v)){t.n=7;break}return t.a(2,d);case 7:f++,t.n=5;break;case 8:return t.a(2,null)}},t)})),T.apply(this,arguments)}function k(n){return n.replace(/[ \t]+\n/g,"\n").replace(/\n{3,}/g,"\n\n").trim()}function x(n){var t=(new DOMParser).parseFromString(n,"text/html"),r=k(t.body?t.body.innerText:n),e=r.match(/4\.\s*1[\s\S]*?(?=4\.\s*2|4\.\s*3|5\.)/i);if(e){var o=e[0],i=o.toLowerCase().indexOf("indicaciones");return i>-1&&(o=o.slice(i)),k(o)}var a=r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),c=a.indexOf("para que se utiliza");if(c>-1){var u=r.slice(c),s=u.match(/^[\s\S]*?(?=\n\s*\d+\s*\.)/m);return k(s?s[0]:u)}var l=a.indexOf("indicaciones");if(l>-1){var f=r.slice(l),p=f.match(/^[\s\S]*?(?=\n\s*\d+\s*\.)/m);return k(p?p[0]:f)}return null}function P(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!Array.isArray(null==n?void 0:n.docs))return null;var r=n.docs.filter(function(n){return n.tipo===t&&n.urlHtml});return r.length?r[0]:n.docs.find(function(n){return n.urlHtml})||null}function U(n){return B.apply(this,arguments)}function B(){return(B=i(n().m(function t(r){var e,o,i,a,c,u,s;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,e=P(r,1),o=P(r,2),(i=e||o)&&i.urlHtml){n.n=1;break}return n.a(2,null);case 1:return n.n=2,h(i.urlHtml);case 2:if(a=n.v,c=x(a)){n.n=3;break}return n.a(2,null);case 3:if(u=1200,!(c.length<=u)){n.n=4;break}return n.a(2,c);case 4:return s=c.lastIndexOf(" ",u-10),n.a(2,c.slice(0,s>0?s:u).trim()+"…");case 5:return n.p=5,n.v,n.a(2,null)}},t,null,[[0,5]])}))).apply(this,arguments)}function j(){return N.apply(this,arguments)}function N(){return(N=i(n().m(function t(){var r,e,o,i,a,l,p,d,v,h,m,y,g;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,c("Buscando..."),u("—"),n.n=1,s();case 1:if(r=n.v){n.n=2;break}return c("Selecciona un nombre comercial."),n.a(2);case 2:return n.n=3,b(r);case 3:if((e=n.v).length){n.n=5;break}return n.n=4,R(r);case 4:(o=n.v)&&o.list&&o.list.length&&(e=o.list);case 5:if(e.length){n.n=6;break}return c("No encontrado en CIMA."),n.a(2);case 6:if(i=e[0],!(a=i.nregistro||i.nregistroId||i.id)){n.n=8;break}return n.n=7,A(a);case 7:y=n.v,n.n=9;break;case 8:y=null;case 9:if((p=C(l=y||i)).length){n.n=10;break}return c("Sin principios activos en la respuesta."),n.a(2);case 10:return d=L(l),v=I(r),h=d||v,n.n=11,f("".concat(h," (").concat(E(p),")"));case 11:return c("Listo."),c("Buscando indicaciones…"),n.n=12,U(l);case 12:(m=n.v)?(u(m),c("Listo.")):(u("No se pudieron extraer las indicaciones de la Ficha Técnica/Prospecto."),c("Listo.")),n.n=14;break;case 13:n.p=13,g=n.v,console.error(g),c("Error consultando CIMA. Revisa tu conexión.");case 14:return n.a(2)}},t,null,[[0,13]])}))).apply(this,arguments)}Office.onReady(function(n){if(n.host===Office.HostType.Word){var t=document.getElementById("sideload-msg"),r=document.getElementById("app-body");t&&(t.style.display="none"),r&&(r.style.display="block");var e=function(){var n=document.getElementById("btnBuscar");n&&!n._h&&(n.addEventListener("click",j),n._h=!0)};e(),document.addEventListener("DOMContentLoaded",e)}})}(),function(){"use strict";new URL(r(58394),r.b)}()}();
//# sourceMappingURL=taskpane.js.map